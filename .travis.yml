language: python
python: '2.7'
before_install:
- sudo apt-get update -qq
- sudo apt-get install -y curl
install:
- pip install ansible
- "{ echo '[defaults]'; echo 'roles_path = ../'; } >> ansible.cfg"
script:
- ansible-playbook -i tests/inventory tests/test.yml --syntax-check
- ansible-playbook -i tests/inventory tests/test.yml --connection=local --sudo
- 'ansible-playbook -i tests/inventory tests/test.yml --connection=local --sudo |
  grep -q ''changed=0.*failed=0'' && (echo ''Idempotence test: pass'' && exit 0) ||
  (echo ''Idempotence test: fail'' && exit 1)

'
env:
  global:
    secure: CP9X6gmdrtd64kkPCDjRRiNLYXP+0r9T1BqfOYGSy6nNbC0/eycFgcrxfSm209deqQvpXEn9klO6vInF1s4lhupWvdE8DH0sY3qMov50FhVfU3BMcZOXCMumrBG1a69ior9NmwudsDk2MGL1GmWlJrcqGwIFVcQ9wYWd8nMhfZs=
