language: python
python: '2.7'
before_install:
- sudo apt-get update -qq
- sudo apt-get install -y curl
install:
- pip install ansible
- "{ echo '[defaults]'; echo 'roles_path = ../'; } >> ansible.cfg"
script:
- ansible-playbook -i tests/inventory tests/test.yml --syntax-check
- ansible-playbook -i tests/inventory tests/test.yml --connection=local --sudo
- 'ansible-playbook -i tests/inventory tests/test.yml --connection=local --sudo |
  grep -q ''changed=0.*failed=0'' && (echo ''Idempotence test: pass'' && exit 0) ||
  (echo ''Idempotence test: fail'' && exit 1)

'
env:
  secure: BURenN8IIFFnvi5aRy8KSG3H+qZPalGaXJL06lSQF3/6UvWUIPWtY6MOl1YyzaZHFZFWhzct+yHglhEm9zPjzWU+/mmiBypE8Tsh8Uh43ululDP9SPKRMfz3nLBFm3EwqygPRVve7NJ1vXkWDBtjfTMwUK2QPD22A3cya7o4kYk=
notifications:
  email: false
